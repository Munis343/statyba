<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Renovation Estimator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #EFF2F5;
      color: #343A40;
    }
    .card {
      background-color: #F8F9FA;
      border-radius: 0.75rem;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.04);
      padding: 1.5rem;
      transition: all 0.2s ease;
    }
    .card:hover {
      transform: scale(1.02);
      background-color: #e9ecef;
    }
    .icon-circle {
      width: 48px;
      height: 48px;
      background-color: #5F7C8D;
      border-radius: 9999px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .icon-circle svg {
      width: 24px;
      height: 24px;
      color: white;
    }
  </style>
</head>
<body>
  <!-- Sticky Header -->
  <header class="sticky top-0 bg-[#4E6E81] text-white shadow z-50">
    <div class="max-w-6xl mx-auto px-4 py-3 flex justify-between items-center flex-wrap gap-y-2">
      <h1 class="text-xl font-semibold">üèóÔ∏è Renovation Estimator</h1>
      <nav class="space-x-2 flex flex-wrap gap-y-2">
        <button onclick="goHome()" class="bg-white text-[#4E6E81] px-3 py-1 rounded hover:bg-gray-100 font-medium">Home</button>
        <button onclick="goTo('newProject')" class="bg-white text-[#4E6E81] px-3 py-1 rounded hover:bg-gray-100 font-medium">New Project</button>
        <button onclick="goTo('myProjects')" class="bg-white text-[#4E6E81] px-3 py-1 rounded hover:bg-gray-100 font-medium">My Projects</button>
      </nav>
    </div>
  </header>
<main id="app" class="max-w-6xl mx-auto p-6 space-y-10">

  <!-- Home Page (Grid Menu) -->
  <section id="homePage" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
    <button onclick="goTo('newProject')" class="card flex flex-col items-center text-center">
      <div class="icon-circle mb-2">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
        </svg>
      </div>
      <span class="font-medium">New Project</span>
    </button>

    <button onclick="goTo('myProjects')" class="card flex flex-col items-center text-center">
      <div class="icon-circle mb-2">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10h18V7H3z"/>
        </svg>
      </div>
      <span class="font-medium">My Projects</span>
    </button>

    <button onclick="goTo('summary')" class="card flex flex-col items-center text-center">
      <div class="icon-circle mb-2">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3v18h18M3 9h18M9 3v6"/>
        </svg>
      </div>
      <span class="font-medium">Summary</span>
    </button>

    <button onclick="goTo('paintingPage')" class="card flex flex-col items-center text-center">
      <div class="icon-circle mb-2 bg-green-600">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7-7-7M5 10l7-7 7 7"/>
        </svg>
      </div>
      <span class="font-medium">Painting</span>
    </button>

    <button onclick="goTo('plumbingPage')" class="card flex flex-col items-center text-center">
      <div class="icon-circle mb-2 bg-blue-600">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2a4 4 0 10-8 0v2m8 0a4 4 0 018 0v2"/>
        </svg>
      </div>
      <span class="font-medium">Plumbing</span>
    </button>
  </section>

  <!-- New Project -->
  <section id="newProjectPage" class="hidden card">
    <h2 class="text-xl font-semibold text-[#4E6E81] mb-4">New Project</h2>
    <div class="grid md:grid-cols-2 gap-4">
      <input id="projName" class="border p-2 rounded w-full" placeholder="Project Name" />
      <input id="projClient" class="border p-2 rounded w-full" placeholder="Client Name" />
      <input id="projAddress" class="border p-2 rounded md:col-span-2" placeholder="Address" />
      <input id="projStart" type="date" class="border p-2 rounded w-full" />
      <input id="projEnd" type="date" class="border p-2 rounded w-full" />
      <input id="projBudget" type="number" class="border p-2 rounded w-full" placeholder="Estimated Budget" />
    </div>
    <div class="mt-4">
      <label class="font-semibold block mb-2">Select Trades:</label>
      <label class="block"><input type="checkbox" value="painting" class="mr-2" /> üé® Painting</label>
      <label class="block"><input type="checkbox" value="plumbing" class="mr-2" /> üîß Plumbing</label>
    </div>
    <textarea id="projNotes" class="w-full border p-2 rounded mt-4" rows="3" placeholder="Project Notes..."></textarea>
    <button onclick="saveNewProject()" class="mt-4 bg-[#5F7C8D] text-white px-4 py-2 rounded hover:bg-[#4E6E81]">üíæ Save Project</button>
  </section>

  <!-- My Projects -->
  <section id="myProjectsPage" class="hidden card">
    <h2 class="text-xl font-semibold text-[#4E6E81] mb-4">My Projects</h2>
    <div id="projectsList" class="space-y-4"></div>
  </section>

  <!-- Painting, Plumbing, Summary (included in Part 3 with logic) -->
</main>

<!-- Project Picker Modal -->
<div id="projectPickerModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
  <div class="bg-white rounded-lg shadow-lg p-6 max-w-md w-full">
    <h3 class="text-lg font-semibold text-[#4E6E81] mb-4">Select a Project</h3>
    <div id="projectPickerList" class="space-y-2"></div>
    <button onclick="closeProjectPicker()" class="mt-4 px-4 py-2 bg-gray-300 hover:bg-gray-400 rounded">Cancel</button>
  </div>
</div>
<script>
let walls = [];
let currentPage = 'home';
let currentProjectId = null;
let projects = JSON.parse(localStorage.getItem('projects') || '[]');

// NAVIGATION
function goTo(page) {
  currentPage = page;
  showPage();
}
function goHome() {
  currentPage = 'home';
  currentProjectId = null;
  showPage();
}
function showPage() {
  const pages = ['homePage', 'newProjectPage', 'myProjectsPage', 'paintingPage', 'plumbingPage', 'summaryPage'];
  pages.forEach(id => document.getElementById(id)?.classList.add('hidden'));
  document.getElementById(`${currentPage}Page`)?.classList.remove('hidden');

  if (currentPage === 'myProjects') renderProjectsList();
  if (currentPage === 'summary') renderSummary();
  if (currentPage === 'paintingPage') renderWalls();
}

// PROJECT LOGIC
function saveNewProject() {
  const name = document.getElementById('projName').value.trim();
  if (!name) return alert("Enter project name.");
  const newProj = {
    id: Date.now(),
    name,
    client: document.getElementById('projClient').value,
    address: document.getElementById('projAddress').value,
    start: document.getElementById('projStart').value,
    end: document.getElementById('projEnd').value,
    budget: document.getElementById('projBudget').value,
    notes: document.getElementById('projNotes').value,
    trades: {},
    selectedTrades: Array.from(document.querySelectorAll('#newProjectPage input[type=checkbox]:checked')).map(c => c.value)
  };
  projects.push(newProj);
  localStorage.setItem('projects', JSON.stringify(projects));
  currentProjectId = newProj.id;
  alert("Project saved!");
  goTo('myProjects');
}

function renderProjectsList() {
  const container = document.getElementById('projectsList');
  container.innerHTML = '';
  projects.forEach(p => {
    const div = document.createElement('div');
    div.className = "p-4 border rounded shadow bg-white flex justify-between items-center";
    div.innerHTML = `
      <div>
        <div class="font-bold text-[#4E6E81]">${p.name}</div>
        <div class="text-sm text-gray-500">${p.client} | ${p.address}</div>
      </div>
      <div class="flex gap-2">
        ${p.selectedTrades.includes('painting') ? `<button class="bg-[#5F7C8D] text-white px-2 py-1 rounded" onclick="openTrade(${p.id}, 'paintingPage')">üé®</button>` : ''}
        ${p.selectedTrades.includes('plumbing') ? `<button class="bg-[#5F7C8D] text-white px-2 py-1 rounded" onclick="openTrade(${p.id}, 'plumbingPage')">üîß</button>` : ''}
        <button class="bg-blue-600 text-white px-2 py-1 rounded" onclick="openTrade(${p.id}, 'summaryPage')">Summary</button>
        <button class="bg-red-500 text-white px-2 py-1 rounded" onclick="deleteProject(${p.id})">Delete</button>
      </div>`;
    container.appendChild(div);
  });
}

function openTrade(id, tradePage) {
  currentProjectId = id;
  goTo(tradePage);
}
function deleteProject(id) {
  if (!confirm("Delete this project?")) return;
  projects = projects.filter(p => p.id !== id);
  localStorage.setItem('projects', JSON.stringify(projects));
  renderProjectsList();
}

// PAINTING MODULE
function addWall() {
  const width = parseFloat(document.getElementById('wallWidth').value);
  const height = parseFloat(document.getElementById('wallHeight').value);
  if (!width || !height) return alert("Enter valid dimensions.");
  walls.push({ width, height });
  renderWalls();
  calculatePaint();
}
function renderWalls() {
  const list = document.getElementById('wallsList');
  list.innerHTML = '';
  walls.forEach((w, i) => {
    const li = document.createElement('li');
    li.textContent = `Wall ${i + 1}: ${w.width}m √ó ${w.height}m = ${(w.width * w.height).toFixed(2)} m¬≤`;
    list.appendChild(li);
  });
}
function calculatePaint() {
  const area = walls.reduce((sum, w) => sum + w.width * w.height, 0);
  const coats = parseInt(document.getElementById('paintCoats').value) || 1;
  const coverage = parseFloat(document.getElementById('paintCoverage').value) || 10;
  const total = (area * coats) / coverage;
  document.getElementById('paintTotal').textContent = total.toFixed(2);
}
function savePaintingData() {
  if (!currentProjectId) return openProjectPicker('painting');
  const p = projects.find(p => p.id === currentProjectId);
  p.trades.painting = {
    walls,
    coats: document.getElementById('paintCoats').value,
    coverage: document.getElementById('paintCoverage').value
  };
  localStorage.setItem('projects', JSON.stringify(projects));
  alert("Painting data saved!");
}

// PLUMBING MODULE
function savePlumbingData() {
  const fixtureCount = parseInt(document.getElementById('fixtureCount').value);
  const pipeLength = parseFloat(document.getElementById('pipeLength').value);
  const installTime = parseFloat(document.getElementById('installTime').value);
  if (!currentProjectId) return openProjectPicker('plumbing');
  const p = projects.find(p => p.id === currentProjectId);
  p.trades.plumbing = {
    fixtureCount,
    pipeLength,
    installTime
  };
  localStorage.setItem('projects', JSON.stringify(projects));
  document.getElementById('plumbingEstimate').textContent = installTime.toFixed(2);
  alert("Plumbing data saved.");
}

// SUMMARY
function renderSummary() {
  const container = document.getElementById('summaryOutput');
  if (!currentProjectId) {
    container.innerHTML = "No project selected.";
    return;
  }
  const p = projects.find(p => p.id === currentProjectId);
  let html = `<div><strong>Project:</strong> ${p.name}</div>`;
  if (p.trades.painting) {
    const area = p.trades.painting.walls.reduce((sum, w) => sum + w.width * w.height, 0);
    const coats = p.trades.painting.coats || 1;
    const coverage = p.trades.painting.coverage || 10;
    const totalPaint = (area * coats) / coverage;
    html += `
      <hr class="my-2" />
      <div><strong>üé® Painting</strong></div>
      <div>Total Wall Area: ${area.toFixed(2)} m¬≤</div>
      <div>Coats: ${coats}</div>
      <div>Coverage: ${coverage} m¬≤/L</div>
      <div><strong>Total Paint:</strong> ${totalPaint.toFixed(2)} L</div>
    `;
  }
  if (p.trades.plumbing) {
    html += `
      <hr class="my-2" />
      <div><strong>üîß Plumbing</strong></div>
      <div>Fixtures: ${p.trades.plumbing.fixtureCount}</div>
      <div>Piping: ${p.trades.plumbing.pipeLength} m</div>
      <div>Estimated Install Time: ${p.trades.plumbing.installTime} hrs</div>
    `;
  }
  container.innerHTML = html;
}

// MODAL
let modalReturnTo = null;
function openProjectPicker(returnTo) {
  modalReturnTo = returnTo;
  document.getElementById('projectPickerModal').classList.remove('hidden');
  const list = document.getElementById('projectPickerList');
  list.innerHTML = '';
  projects.forEach(p => {
    const btn = document.createElement('button');
    btn.textContent = p.name;
    btn.className = "w-full text-left bg-[#EFF2F5] hover:bg-[#dee2e6] px-3 py-2 rounded";
    btn.onclick = () => {
      currentProjectId = p.id;
      document.getElementById('projectPickerModal').classList.add('hidden');
      if (modalReturnTo === 'painting') savePaintingData();
      if (modalReturnTo === 'plumbing') savePlumbingData();
    };
    list.appendChild(btn);
  });
}
function closeProjectPicker() {
  document.getElementById('projectPickerModal').classList.add('hidden');
  modalReturnTo = null;
}

// INIT
showPage();
</script>
</body>
</html>
